<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{UI/layouts/user/main_layout}"
      >
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Detail</title>
  <style>
    .product-image {
      width: 255px;
      height: 400px;
      object-fit: cover;
      border-radius: 8px;
    }
    
    .product-details {
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      width: 500px;
      max-width: 100%;
    }
    
    .product-name {
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 24px;
      line-height: 1.5;
      color: #000;
      margin: 0;
    }
    
    .product-sku {
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 16px;
      line-height: 1.5;
      color: #666;
    }
    
    .product-price {
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 20px;
      font-weight: 700;
      line-height: 1.5;
      color: #21257E;
    }
    
    .quantity-section {
      width: 140px;
    }
    
    .quantity-label {
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 14px;
      line-height: 1.5;
      color: #666;
      margin-bottom: 10px;
    }
    
    .quantity-control {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border: 1px solid #666;
      width: 93px;
      border-radius: 4px;
    }
    
    .quantity-btn {
      border: none;
      background: none;
      width: 16px;
      height: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      padding: 0;
    }
    
    .quantity-input {
      border: none;
      background: none;
      text-align: center;
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 14px;
      color: #000;
      width: 21px;
      outline: none;
    }
    
    .add-to-cart-btn {
      width: 400px;
      height: 43px;
      background: #212529;
      border: 1px solid #212529;
      border-radius: 6px;
      color: white;
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 16px;
      font-weight: 400;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .add-to-cart-btn:hover {
      background: #343a40;
      border-color: #343a40;
    }
    
    .sold-out-btn {
      width: 400px;
      height: 43px;
      background: transparent;
      border: 1px solid #6c757d;
      border-radius: 6px;
      color: #6c757d;
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 16px;
      font-weight: 400;
      cursor: not-allowed;
      opacity: 0.65;
    }
    
    .sold-out-btn:hover {
      background: transparent;
      border-color: #6c757d;
      color: #6c757d;
    }
    
    .breadcrumb-nav {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      margin-bottom: 20px;
    }
    
    .breadcrumb-item {
      font-family: 'Helvetica Neue', sans-serif;
      font-size: 16px;
      color: #0D6EFD;
      text-decoration: none;
    }
    
    .breadcrumb-item.current {
      color: #6C757D;
    }
    
    .breadcrumb-separator {
      color: #6C757D;
    }
    
    .product-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 80px;
      width: 1080px;
      max-width: 100%;
      margin: 0 auto;
      padding: 50px 0;
    }
    
    .product-image-section {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 10px;
      padding: 10px;
      width: 500px;
      max-width: 100%;
    }
    
    /* 모바일 플로팅 버튼 */
    .mobile-floating-buttons {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      flex-direction: column;
      gap: 10px;
    }
    
    .floating-btn {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .floating-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
    }
    
    .floating-cart-btn {
      background: #ffffff;
      color: #212529;
      border: 2px solid #dee2e6;
    }
    
    .floating-add-cart-btn {
      background: #212529;
      color: white;
    }
    
    .floating-sold-out-btn {
      background: #6c757d;
      color: white;
      opacity: 0.65;
      cursor: not-allowed;
    }
    
    .floating-sold-out-btn:hover {
      transform: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }
    
    /* 반응형 */
    @media (max-width: 768px) {
      .mobile-floating-buttons {
        display: flex;
      }
      
      .product-container {
        flex-direction: column;
        gap: 30px;
        padding: 20px 0;
      }
      
      .product-details {
        width: 100%;
        padding: 0 20px;
      }
      
      .add-to-cart-btn {
        width: 100%;
        max-width: 400px;
      }
    }
  </style>
</head>
<body layout:fragment="content">

  <section id="product-detail" class="container-fluid">

    <div class="product-container container">
      <div class="d-flex flex-column flex-md-row justify-content-between align-items-center w-100">
        <!-- Breadcrumb -->
        <div class="breadcrumb-nav justify-content-center">
          <a href="/" class="breadcrumb-item">
            <svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
              <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z"/>
            </svg>
            Home
          </a>
          <span class="breadcrumb-separator">/</span>
          <a href="/products" class="breadcrumb-item">Products</a>
          <span class="breadcrumb-separator">/</span>
          <span class="breadcrumb-item current" th:text="${product.name}">King Blue</span>
        </div>
  
        <!-- prev, next -->
        <div class="product-navigation">
            <a th:if="${prevProduct != null}" th:href="@{/products/{id}(id=${prevProduct.id})}" class="btn btn-outline-secondary">Prev</a>
            <a th:if="${nextProduct != null}" th:href="@{/products/{id}(id=${nextProduct.id})}" class="btn btn-outline-secondary">Next</a>
        </div>
  
      </div>

    </div>

    <!-- 상품이 없을 때-->
    <div th:unless="${product != null}" class="text-center py-5">
      <p>Unable to load product information.</p>
    </div>
    
    <!-- 상품 정보 -->
    <div th:if="${product != null}" class="product-container">
      
   <!-- 상품 이미지 -->
   <div class="product-image-section">
     <img th:if="${product.mainImg != null}" 
       th:src="${product.mainImg.content}" 
       class="product-image cursor-pointer" 
       alt="Product Image" 
       data-bs-toggle="modal" 
       data-bs-target="#imageModal">
     <img th:if="${product.mainImg == null}" 
       src="https://placehold.co/255x400?text=No+Image" 
       class="product-image" 
       alt="No Image">
             
        <!-- Image Modal -->
        <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="imageModalLabel">Product Image</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body text-center">
                <img id="modalImage" src="" class="img-fluid" alt="Product Image">
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 상품 상세 정보 -->
      <div class="product-details">
        
        <!-- 상품명 -->
        <h2 class="product-name" th:text="${product.name}">King Blue</h2>
        
        <!-- SKU -->
        <div class="product-sku">
          SKU: <span th:text="${product.no}">002</span>
        </div>
        
        <!-- 가격 -->
        <div class="product-price">
          <th:block th:text="${product.price == null ? '' : '£' + #numbers.formatInteger(product.price, 0, 'COMMA')}">£52.30</th:block>
        </div>
        
        <!-- Quantity 섹션 -->
        <div class="quantity-section">
          <div class="quantity-label">Quantity *</div>
          <div class="quantity-control">
            <button type="button" id="decreaseQty" class="quantity-btn">
              <span class="material-icons">remove</span>
            </button>
            <input type="text" id="quantity" value="1" class="quantity-input" readonly>
            <button type="button" id="increaseQty" class="quantity-btn">
              <span class="material-icons">add</span>
            </button>
          </div>
        </div>

        <!-- totalPrice 섹션 -->
        <div class="total-price-section product-price">
          Total Price: <span id="totalPrice" class="product-price" th:text="${product.price == null ? '' : '£' + #numbers.formatInteger(product.price, 0, 'COMMA')}">£52.30</span>
        </div>

        <!-- Add to Cart 버튼 -->
        <div class="d-flex gap-2 justify-content-between">
          <button type="button" id="" class="btn btn-outline-dark" onclick="showCartOffcanvas()">
            <span class="material-icons">shopping_bag</span>
          </button>
          
          <!-- 품절이 아닌 경우 -->
          <button type="button" id="addToCartBtn" class="add-to-cart-btn" th:if="${!product.isSoldOut}">
            Add to Cart
          </button>
          
          <!-- 품절인 경우 -->
          <button type="button" class="sold-out-btn" disabled th:if="${product.isSoldOut}">
            Sold Out
          </button>
        </div>

        <!-- Order -->
        <div class="d-flex gap-2">
          <button type="button" class="btn btn-outline-dark w-100" th:if="${!product.isSoldOut}" onclick="orderNow()">Order Now</button>
        </div>
        
      </div>
    </div>
  </section>

  <!-- 모바일 플로팅 버튼 -->
  <div class="mobile-floating-buttons">
    <button type="button" class="floating-btn floating-cart-btn" onclick="showCartOffcanvas()">
      <span class="material-icons">shopping_bag</span>
    </button>
    
    <!-- 품절이 아닌 경우 -->
    <button type="button" class="floating-btn floating-add-cart-btn" id="mobileAddToCartBtn" th:if="${!product.isSoldOut}">
      <span class="material-icons">add_shopping_cart</span>
    </button>
    
    <!-- 품절인 경우 -->
    <button type="button" class="floating-btn floating-sold-out-btn" disabled th:if="${product.isSoldOut}">
      <span class="material-icons">block</span>
    </button>
  </div>

  <!-- 장바구니 오프캔버스 -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel" style="width: 400px;">
    <div class="offcanvas-header" style="padding: 20px; border-bottom: 1px solid #dee2e6;">
      <h5 class="offcanvas-title" id="cartOffcanvasLabel" style="font-family: 'Helvetica Neue', sans-serif; font-size: 20px; font-weight: 600; color: #000;">
        Shopping Cart
      </h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body" style="padding: 20px;">
      <div id="cartItems">
        <!-- 장바구니 아이템들이 여기에 로드됩니다 -->
        <div class="text-center text-muted">
          Your cart is empty.
        </div>
      </div>
      
      <!-- 장바구니 합계 -->
      <div id="cartSummary" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #dee2e6; display: none;">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <span style="font-family: 'Helvetica Neue', sans-serif; font-size: 16px; color: #666;">Total:</span>
          <span id="cartTotal" style="font-family: 'Helvetica Neue', sans-serif; font-size: 20px; font-weight: 700; color: #21257E;">£0</span>
        </div>
        <button type="button" class="btn w-100" id="checkoutBtn" style="background: #212529; color: white; border: 1px solid #212529; border-radius: 6px; padding: 12px; font-family: 'Helvetica Neue', sans-serif; font-size: 16px;">
          Checkout
        </button>
      </div>
    </div>
  </div>

  <script th:inline="javascript">
    var userName = [[${ session.SPRING_SECURITY_CONTEXT != null ? #authentication.principal.user.name : '' }]]
    var isLogin = userName || false;
    var productNo = [[${product.no}]]
    var productId = [[${product.id}]]
    var basePrice = [[${product.price}]]
    var price = [[${product.price}]]
    var isSoldOut = [[${product.isSoldOut}]]
  </script>
  
  <script>
    // 이미지 모달 스크립트
    document.querySelector('.product-image').addEventListener('click', function() {
      document.getElementById('modalImage').src = this.src;
    });
    
    // Quantity 컨트롤
    let currentQuantity = 1;
    const quantityInput = document.getElementById('quantity');
    const decreaseBtn = document.getElementById('decreaseQty');
    const increaseBtn = document.getElementById('increaseQty');
    
    // 품절 상품일 때 수량 조절 비활성화
    if (isSoldOut) {
      decreaseBtn.disabled = true;
      increaseBtn.disabled = true;
      quantityInput.disabled = true;
      decreaseBtn.style.opacity = '0.5';
      increaseBtn.style.opacity = '0.5';
      decreaseBtn.style.cursor = 'not-allowed';
      increaseBtn.style.cursor = 'not-allowed';
    } else {
      decreaseBtn.addEventListener('click', function() {
        if (currentQuantity > 1) {
          currentQuantity--;
          quantityInput.value = currentQuantity;
          // id="totalPrice" 업데이트
          price = basePrice * currentQuantity;
          document.getElementById('totalPrice').innerText = '£' + (price).toFixed(2);

        }

      });
      
      increaseBtn.addEventListener('click', function() {
        currentQuantity++;
        quantityInput.value = currentQuantity;
        // id="totalPrice" 업데이트
        price = basePrice * currentQuantity;
        document.getElementById('totalPrice').innerText = '£' + (price).toFixed(2);
      });
    }
    
    // 장바구니 버튼 이벤트
    const addToCartBtn = document.getElementById('addToCartBtn');
    if (addToCartBtn && !isSoldOut) {
      addToCartBtn.addEventListener('click', function() {
        addToCart();
      });
    }
    
    // 모바일 플로팅 버튼 이벤트
    const mobileAddToCartBtn = document.getElementById('mobileAddToCartBtn');
    if (mobileAddToCartBtn && !isSoldOut) {
      mobileAddToCartBtn.addEventListener('click', function() {
        addToCart();
      });
    }
    
    // 장바구니 추가 공통 함수
    function addToCart() {
      // 품절 상품 체크
      if (isSoldOut) {
        $alert({
          title: 'Sold Out',
          text: 'This product is currently sold out and cannot be ordered.',
          icon: 'warning',
          confirmButtonText: 'OK'
        });
        return;
      }
      
      if (!isLogin) {
        $alert_({
          title: 'Login Required',
          text: 'You need to log in to use the cart.',
          icon: 'warning',
          confirmButtonText: 'Login',
          cancelButtonText: 'Cancel',
          showCancelButton: true
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/login?redirect=/products/' + productId;
          }
        });
        return;
      }

      // 장바구니 데이터
      const cartData = {
        productNo: productNo,
        quantity: currentQuantity,
        totalPrice: basePrice * currentQuantity,
        options: '[]' // 빈 옵션 배열
      };
      
      $ajax({
        url: '/api/users/cart',
        type: 'POST',
        data: cartData
      }).then(function(result) {
        if (result === 'FAIL') {
          $alert({
            title: 'Cart Registration Failed',
            text: 'An error occurred while adding to cart. Please try again.',
            icon: 'error',
            confirmButtonText: 'OK'
          });
          return;
        }
        
        // 장바구니 오프캔버스 열기
        showCartOffcanvas();
        
      }).catch(function(error) {
        console.error('장바구니 등록 오류:', error);
        $alert({
          title: 'Cart Registration Failed',
          text: 'An error occurred while adding to cart.',
          icon: 'error',
          confirmButtonText: 'OK'
        });
      });
    }
    
    // 장바구니 오프캔버스 관련 함수들
    function showCartOffcanvas() {
      loadCartItems();
      const offcanvas = new bootstrap.Offcanvas(document.getElementById('cartOffcanvas'));
      offcanvas.show();
    }
    
    function loadCartItems() {
      $ajax({
        url: '/api/users/cart',
        type: 'GET'
      }).then(function(cartList) {
        renderCartItems(cartList);
      }).catch(function(error) {
        console.error('장바구니 로드 오류:', error);
      });
    }
    
    function renderCartItems(cartList) {
      const cartItemsDiv = document.getElementById('cartItems');
      const cartSummary = document.getElementById('cartSummary');
      const cartTotal = document.getElementById('cartTotal');
      
      if (!cartList || cartList.length === 0) {
        cartItemsDiv.innerHTML = '<div class="text-center text-muted">Your cart is empty.</div>';
        cartSummary.style.display = 'none';
        return;
      }
      
      let totalAmount = 0;
      let itemsHtml = '';
      
      cartList.forEach(cart => {
        // product가 null인 경우 스킵
        if (!cart.product) {
          console.warn('Cart item without product:', cart);
          return;
        }
        
        const itemTotal = cart.quantity * cart.product.price;
        totalAmount += itemTotal;
        
        itemsHtml += `
          <div class="cart-item d-flex align-items-stretch mb-3 p-3" style="border: 1px solid #dee2e6; border-radius: 8px;">
            <div class="cart-item-image me-3 d-flex align-items-center">
              <img src="${cart.product.mainImg ? cart.product.mainImg.content : 'https://placehold.co/60x60?text=No+Image'}" 
                   alt="${cart.product.name}" 
                   style="width: 60px; height: 60px; object-fit: contain; border-radius: 4px;">
            </div>
            <div class="cart-item-details flex-grow-1 d-flex flex-column justify-content-between">
              <h6 style="font-family: 'Helvetica Neue', sans-serif; font-size: 14px; font-weight: 600; color: #000; margin-bottom: 4px;">
                ${cart.product.name}
              </h6>
              <div style="font-family: 'Helvetica Neue', sans-serif; font-size: 12px; color: #666; margin-bottom: 4px;">
                SKU: ${cart.product.no}
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <div class="quantity-controls d-flex align-items-center">
                  <button type="button" class="btn btn-sm" onclick="updateCartQuantity('${cart.id}', ${cart.quantity - 1})" 
                          style="border: 1px solid #dee2e6; width: 30px; height: 30px; padding: 0; display: flex; align-items: center; justify-content: center;">
                    <span class="material-icons">remove</span>
                  </button>
                  <span style="margin: 0 10px; font-family: 'Helvetica Neue', sans-serif; font-size: 14px; min-width: 20px; text-align: center;">
                    ${cart.quantity}
                  </span>
                  <button type="button" class="btn btn-sm" onclick="updateCartQuantity('${cart.id}', ${cart.quantity + 1})" 
                          style="border: 1px solid #dee2e6; width: 30px; height: 30px; padding: 0; display: flex; align-items: center; justify-content: center;">
                    <span class="material-icons">add</span>
                  </button>
                </div>
                <div style="font-family: 'Helvetica Neue', sans-serif; font-size: 14px; font-weight: 600; color: #21257E;">
                  £${itemTotal.toLocaleString()}
                </div>
              </div>
            </div>
            <div class="d-flex justify-content-between align-items-start">
              <button type="button" class="btn btn-sm ms-2" onclick="removeCartItem('${cart.id}')" 
                      style="color: #dc3545; border: none; background: none; padding: 5px;">
                <span class="material-icons">delete</span>
              </button>
            </div>
          </div>
        `;
      });
      
      cartItemsDiv.innerHTML = itemsHtml;
      cartTotal.textContent = '£' + totalAmount.toLocaleString();
      cartSummary.style.display = 'block';
    }
    
    function updateCartQuantity(cartNo, newQuantity) {
      if (newQuantity < 1) {
        removeCartItem(cartNo);
        return;
      }
      
      $ajax({
        url: '/api/users/cart',
        type: 'PUT',
        data: { 
          id: cartNo,
          quantity: newQuantity 
        }
      }).then(function(result) {
        console.log('수량 업데이트 결과:', result);
        loadCartItems(); // 장바구니 새로고침
      }).catch(function(error) {
        console.error('장바구니 수량 업데이트 오류:', error);
        $alert({
          title: 'Quantity Update Failed',
          text: 'An error occurred while updating quantity.',
          icon: 'error',
          confirmButtonText: 'OK'
        });
      });
    }
    
    function removeCartItem(cartNo) {
      $ajax({
        url: '/api/users/cart/' + cartNo,
        type: 'DELETE'
      }).then(function(result) {
        console.log('삭제 결과:', result);
        loadCartItems(); // 장바구니 새로고침
        
        // 성공 메시지 표시
        $alert({
          title: 'Removed',
          text: 'The product has been removed from your cart.',
          icon: 'success',
          confirmButtonText: 'OK',
          timer: 1500
        });
      }).catch(function(error) {
        console.error('장바구니 삭제 오류:', error);
        $alert({
          title: 'Remove Failed',
          text: 'An error occurred while removing the product.',
          icon: 'error',
          confirmButtonText: 'OK'
        });
      });
    }
    
    // Checkout 버튼 이벤트
    document.addEventListener('DOMContentLoaded', function() {
      const checkoutBtn = document.getElementById('checkoutBtn');
      if (checkoutBtn) {
        checkoutBtn.addEventListener('click', function() {
          // 장바구니에 상품이 있는지 확인
          $ajax({
            url: '/api/users/cart',
            type: 'GET'
          }).then(function(cartList) {
            if (!cartList || cartList.length === 0) {
              $alert({
                title: 'Cart is Empty',
                text: 'There are no products to order.',
                icon: 'warning',
                confirmButtonText: 'OK'
              });
              return;
            }
            
            // 전체 장바구니 상품으로 주문 생성 페이지 이동
            window.location.href = '/carts/create/all';
            
          }).catch(function(error) {
            console.error('장바구니 확인 오류:', error);
            $alert({
              title: 'Error Occurred',
              text: 'An error occurred while checking the cart.',
              icon: 'error',
              confirmButtonText: 'OK'
            });
          });
        });
      }
    });
    

    
    function orderNow() {
      const totalQuantity = document.getElementById('quantity').value

      if (!isLogin) {
        $alert_({
          title: 'Login Required',
          text: 'You need to log in to purchase.',
          icon: 'warning',
          confirmButtonText: 'Login',
          cancelButtonText: 'Cancel',
          showCancelButton: true
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = '/login?redirect=/products/' + /*[[${product.id}]]*/ '';
          }
        });
        return;
      }
      // 주문 데이터 생성
      const orderData = {
        title: "[[${product.name}]]",
        totalPrice: price,
        totalQuantity: totalQuantity,
        totalItemCount: 1,
        status: '결제대기',
        orderItems: [{
          productNo: "[[${product.no}]]",
          quantity: 1,
          price: "[[${product.price}]]",
        }],
      };

      console.dir(orderData);
      
      // 주문 생성 API 호출
      $ajax({
        url: '/orders/create',
        type: 'POST',
        data: orderData
      }).then(function(data) {
        console.log('주문 성공 여부:', data);
        if( data == 'FAIL' ) {
          $alert({
            title: 'Order Creation Failed',
            text: 'An error occurred while creating the order. Please try again.',
            icon: 'error',
            confirmButtonText: 'OK'
          });
          return;
        }
        $toast_({
          title: 'Order Created Successfully',
          icon: 'success',
          timer: 1000,
        }).then(() => {
          // 주문 생성 후 결제 페이지로 이동
          window.location.href = `/pay/order/${data.id}`;
        });
      }).catch(function(error) {
        console.error('주문 생성 오류:', error);
        alert('An error occurred while creating the order.');
      });
    }
  </script>

</body>
</html>
